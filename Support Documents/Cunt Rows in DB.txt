SELECT 
    s.name AS SchemaName,
    t.name AS TableName,
    SUM(p.rows) AS [RowCount]
FROM 
    sys.tables AS t
JOIN 
    sys.schemas AS s ON t.schema_id = s.schema_id
JOIN 
    sys.partitions AS p ON t.object_id = p.object_id
WHERE 
    p.index_id IN (0,1) -- 0 = heap, 1 = clustered index
GROUP BY 
    s.name, t.name
ORDER BY 
    [RowCount] DESC;
